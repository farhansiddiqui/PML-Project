<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Activity prediction from accelerometer data</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Activity prediction from accelerometer data</h1>

<h2>Farhan Siddiqui</h2>

<h2>Friday, October 24, 2014</h2>

<p>This paper explores the use of acceleromoter data from the belt, forearm, arm, and dumbell of 6 participants in order to predict barbell lifts correctly and incorrectly in 5 different ways. More information is available from the website here: <a href="http://groupware.les.inf.puc-rio.br/har">http://groupware.les.inf.puc-rio.br/har</a> (see the section on the Weight Lifting Exercise Dataset). </p>

<p>The training data for this project are available here: </p>

<p><a href="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv">https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv</a></p>

<p>The test data are available here: </p>

<p><a href="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv">https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv</a></p>

<pre><code class="r">#read data
set.seed(1234)
setwd(&quot;~/R/PracticalML/Project&quot;)
activity &lt;- read.csv(file=&quot;pml-training.csv&quot;,head=TRUE,sep=&quot;,&quot;, na.strings=c(&quot;NA&quot;, &quot;#DIV/0!&quot;))
</code></pre>

<p>We first explore the training dataset provided</p>

<pre><code class="r">str(activity)
</code></pre>

<p>Structure command reveals that a large number of columns have lots of NAs. We now visualize the number of NAs graphically.</p>

<pre><code class="r">hist(colSums(is.na(activity)), main=&quot;# of NAs vs. # Freq of Columns&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAnFBMVEX9/v0AAAAAACoAAFQAKioAKlQAKn8AVX8AVakqAAAqACoqAFQqKn8qVakqf38qf9NUAABUACpUAFRUKgBUKn9UVQBUVSpUVVRUqalUqf1/KgB/Kip/KlR/VQB/f1R/qX9/1Kl/1NN/1P2pVQCpVSqpqVSp1H+p/qmp/tOp/v3TfyrT1H/T/qnT/tPT/v39qVT91H/9/qn9/tP9/v1jq8bgAAAANHRSTlP///////////////////////////////////////////////////////////////////8AS1ciZQAAAAlwSFlzAAALEgAACxIB0t1+/AAADV9JREFUeJztnQ1/6rYZR2uypdBkNfeuXQvp2g7W2+J22MD3/26T5BeMY0JMLMvwP+d3bwwGHhkfS3oEFv7qAJJ8FXoDIAyIFwXxoiBeFMSLgnhREC8K4kVBvCiIFwXxoiBeFMSLgnhREC8K4kVBvCiIFwXxoiBeFMSLgnhREC8K4kVBvCjjF59OVtksPl2XzaLJyix382hxOOyXDxv7N5peE9W8zrF43wvLol3hUVTfsN3cbseNMH7xycMmKXZ1xbrQZPb947YQb4x02O/HqB3Fl0Uf0vxltYMN8X2yXz5u1+UOTVwdc6qM8LzSxYX4JPrBOTEHQHkErJ0W+7e2shk1f7W7MfmXrc1JcRTYYr6du3Jaija3YrvWHj35Y068i7Yzr0qjr5emyMTGMit/y8tvbkc4Ri6+rI757l/ndawu/uH7YmebP19m06IBLp6f2uVuPlnVVzaj1sS7VXkhcVla8aJXRWczu9gvF9VjTfEldmX1jJPtCMnIxdsdvNjN4+KmqV7WY62pN7Zjt7Oz2bRYHverqcMrZ7++shm1spInCe6pNpIrLS0svS46rbr36rGGeBsiWtgHXOvQuh3hGL140xOn1b62LXdi7tXEb9aT/9idbVfb/65SHbuG2D33ZGUjak28bbaLmmofd+1H2XY0iz6Krx5riC+bACveHRqP21fbEY6Riz9plNvF7+ZfL2utqetGj4n341/zsm+NqhTxXFPfRfyxqX9L/OM2F1+sbGxHSEYu3uzZ6WFdtI+tTb2t63mrGkW1rK5IvdeTn6uauT4m7vWoDfFVa+xKS8429aby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" alt="plot of chunk unnamed-chunk-3"/> 
<br>
As can be seen from the histogram, about 100 columns have mostly NAs in the data set. To reduce the dimensionality of the data, we will now exclude any columns which have more than 95% NAs in the data as the information content of such columns is extremely low and they would not add much to prediction accuracy.</p>

<pre><code class="r">activity &lt;- activity[,colSums(is.na(activity))&lt; 0.95*nrow(activity)]
</code></pre>

<p>We are still left with 59 predictors and 1 response varibale in the dataset. We will now use PCA to further reduce the number of predictors. We exclude first 7 predictors as they are indexes, names and dates that should not have any precitive value.</p>

<pre><code class="r">library(caret)
inTrain &lt;- createDataPartition(y=activity$classe, p=0.7, list=FALSE)
training &lt;- activity[inTrain,]
testing &lt;- activity[-inTrain,]
pr &lt;-prcomp(training[,-c(1:7,60)], center=T, scale=T)
</code></pre>

<pre><code class="r">print(paste(&quot;Number of Principal Components : &quot;,length(pr$sdev)))
</code></pre>

<pre><code>## [1] &quot;Number of Principal Components :  52&quot;
</code></pre>

<pre><code class="r">plot(pr$x,col=training$classe,xlab=&#39;PC1&#39;,ylab=&#39;PC2&#39;,main=&quot;PC1 vs. PC2; Color = Activity Class&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6"/> 
Next we will use cross validation to explore how prediction error rate varies with # of predictors.</p>

<pre><code class="r">trainPC=predict(pr,training[,-c(1:7,60)])
library(randomForest)
</code></pre>

<pre><code class="r">cv &lt;- rfcv(trainPC, training$classe)
cv$error
</code></pre>

<pre><code>##         52         26         13          6          3          1 
## 0.02467788 0.03203028 0.05001092 0.12651962 0.42025187 0.73589576
</code></pre>

<pre><code class="r">plot(cv$n.var,cv$error,type=&quot;b&quot;,xlab=&quot;# of predictors&quot;,ylab=&quot;cv error&quot;, main=&quot;# of predictors vs. cv error&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAjVBMVEX9/v0AAAAAACoAAFQAKioAKlQAKn8AVakqAAAqACoqAFQqKlQqKn8qVakqf38qf9NUAABUACpUAFRUKgBUVSpUqalUqf1/KgB/Kip/KlR/fyp/f1R/qX9/1Kl/1NN/1P2pVQCpqVSp1H+p/tOp/v3TfyrT1H/T/qnT/tPT/v39qVT91H/9/qn9/tP9/v3msDnOAAAAL3RSTlP/////////////////////////////////////////////////////////////AFqlOPcAAAAJcEhZcwAACxIAAAsSAdLdfvwAAA4bSURBVHic7Z0Ne6PGFUaD3a7dzbbSJqm0SduIpFbS1Yf//88rM4CEvJI1aC7MoPec58k6RqML1uHODAgu372CJN+l3gBIA+JFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvyrTEbx5W2+fZ6bLtc/GwuvbG3fzD19388eW4pFxYb9y0mJb49ePL+q3lsghQ6MT3f9c9Mynx++WHr2WbtuuiKGbVouqHl7pfPv5WFNWr++XDT64TcA0W/oWi+Geb8e6Xxxf/rqc2RvuOqu8omuile9X/21nYbIP//djgsDGLNtCvnQ04Rh/xcwphQuK9rVZz9Zk7nrrim1ebRXWD2XG5E1//8vjfWnwTo9l7/pwfo2/cz938YbXrLDxuxOPLocHrcWPa3fB/3Q146uybOTEh8W44X+zms+Z/q8/cf/Btp119vrNqSbGo/ufJNag+66oXeNk+Vwm6bsT7X9w73H+HGJ13NFRZuvL2uwvr9dYBDg3qhc266kBtuJPouTEp8dX4vmk0b/yHuW4UOtwH75bMvJOqgce94+k4udsUzdTQvesQo36HT+7jQDLzbU4W+vXOThvUC5t11YHaDTiJnhsTEn/S1d8svkm+M+L9cN4OxtUb/vRHAd2Fh/V2G7wifmj2y2pYbnred7t690Ef+uhvu/o2WTud8UHNYbZfPvyrTe7uIcAhQLfBYV1d8eeiZ8SUxFeH8Lt5O1y2U6eu+HZy5z/osjvXezO5c8P0yeSuNlV0uvXm9EC7sD0JcAhwcv6gPFn1yQa00XNjSuKr8b2a3rW/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" alt="plot of chunk unnamed-chunk-8"/> 
<br>
Since error rate continues to drop as we include more predictors and as we want our model to be as accurate as possible, we will use all of the principal components to train our model.</p>

<pre><code class="r">modelFit &lt;- randomForest(training$classe~ .,data=trainPC)
modelFit
</code></pre>

<pre><code>## 
## Call:
##  randomForest(formula = training$classe ~ ., data = trainPC) 
##                Type of random forest: classification
##                      Number of trees: 500
## No. of variables tried at each split: 7
## 
##         OOB estimate of  error rate: 2.1%
## Confusion matrix:
##      A    B    C    D    E class.error
## A 3897    4    1    2    2 0.002304147
## B   57 2572   25    1    3 0.032355154
## C    3   32 2349   12    0 0.019616027
## D    5    1   97 2144    5 0.047957371
## E    0   12   19    7 2487 0.015049505
</code></pre>

<p>This gives us an OOB estimate of  error rate of about 2%</p>

<pre><code class="r">testPC=predict(pr,testing[,-c(1:7,60)])
confusionMatrix(testing$classe,predict(modelFit,testPC))
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1671    2    0    1    0
##          B   28 1100    7    2    2
##          C    0   10 1009    7    0
##          D    3    0   35  925    1
##          E    0    7    5    4 1066
## 
## Overall Statistics
##                                          
##                Accuracy : 0.9806         
##                  95% CI : (0.9768, 0.984)
##     No Information Rate : 0.2892         
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
##                                          
##                   Kappa : 0.9755         
##  Mcnemar&#39;s Test P-Value : NA             
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9818   0.9830   0.9555   0.9851   0.9972
## Specificity            0.9993   0.9918   0.9965   0.9921   0.9967
## Pos Pred Value         0.9982   0.9658   0.9834   0.9595   0.9852
## Neg Pred Value         0.9926   0.9960   0.9903   0.9972   0.9994
## Prevalence             0.2892   0.1901   0.1794   0.1596   0.1816
## Detection Rate         0.2839   0.1869   0.1715   0.1572   0.1811
## Detection Prevalence   0.2845   0.1935   0.1743   0.1638   0.1839
## Balanced Accuracy      0.9905   0.9874   0.9760   0.9886   0.9969
</code></pre>

<p>As can be seen from the confusion matrix, we were able to precit over 98% of our test data set activity label correctly. Now that we have confidence in our model, we will use it to predict 20 test cases.</p>

<pre><code class="r">testing &lt;- read.csv(file=&quot;pml-testing.csv&quot;,head=TRUE,sep=&quot;,&quot;, na.strings=c(&quot;NA&quot;, &quot;#DIV/0!&quot;))
testPC=predict(pr,testing[,-c(1:7)])
answers = predict(modelFit,testPC)
answers
</code></pre>

<pre><code>##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 
##  B  A  B  A  A  E  D  B  A  A  B  C  B  A  E  E  A  B  B  B 
## Levels: A B C D E
</code></pre>

<p>Finally we will write each answer as a sperate text file in order to submit the solution.</p>

<pre><code class="r">pml_write_files = function(x){
  n = length(x)
  for(i in 1:n){
    filename = paste0(&quot;problem_id_&quot;,i,&quot;.txt&quot;)
    write.table(x[i],file=filename,quote=FALSE,row.names=FALSE,col.names=FALSE)
  }
}

pml_write_files(answers)
</code></pre>

</body>

</html>
